define("attachment-validation-filesize-messages",{prefix:"attachment.validation.filesize.",keys:["errorMessage"]});
require(["jquery","xwiki-l10n!attachment-validation-filesize-messages","xwiki-events-bridge"],(d,g)=>{function f(c){if(!+c)return"0 bytes";const a=Math.floor(Math.log(c)/Math.log(1024));return`${parseFloat((c/Math.pow(1024,a)).toFixed(2))}${" bytes;Kb;Mb;Gb;Tb;Pb;Eb;Zb;Yb".split(";")[a]}`}const e={};d(document).on("xwiki:actions:beforeUpload",(c,a)=>{if(a.documentReference){e[a.documentReference]||d.ajax({url:(new XWiki.Document(XWiki.Model.resolve("XWiki.Attachment.Validation.Code.FileSizeValidation",
XWiki.EntityType.DOCUMENT))).getURL("get",d.param({outputSyntax:"plain",documentReference:a.documentReference})),async:!1,method:"GET",success:function(h){e[a.documentReference]=h}});var b=e[a.documentReference]}else b=document.getElementById("attachment-validation-filesize-configuration").textContent;b=JSON.parse(b).maxFileSize;a.file.size>b&&(b=g.get("errorMessage",a.file.name,f(a.file.size),f(b)),new XWiki.widgets.Notification(b,"error"),c.preventDefault())})});